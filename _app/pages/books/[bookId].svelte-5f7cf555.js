import{O as t,S as e,i as n,s as o,e as r,c as l,a,d as s,f as c,G as i,T as u,z as d,U as f,b as h,B as m,r as p,u as g,v as b,t as k,g as v,E as $,l as x,j as E,m as w,o as y,w as T,V as I,J as j,W as _,k as B,n as C,X as V,Y as D,h as S,K as N,L as O,M as q,Z as L,H as P}from"../../chunks/vendor-4bd301cf.js";import{p as A,b as H}from"../../chunks/books-ddbe9465.js";import{_ as M}from"../../chunks/preload-helper-9f12a5fd.js";var z;(z||(z={})).Text="text";const R=A("blocks",{table:new t.Table});function U(e,n){let o;return R.change((({table:r})=>{const l={bookId:e,type:n};var a;null!==(a=l)&&"object"==typeof a&&a.type===z.Text&&(l.text=new t.Text),o=r.add(l)})),o}function F(t){let e;return{c(){e=r("div")},l(t){e=l(t,"DIV",{}),a(e).forEach(s)},m(n,o){c(n,e,o),t[3](e)},p:i,i:i,o:i,d(n){n&&s(e),t[3](null)}}}function G(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,l){function a(t){try{c(o.next(t))}catch(e){l(e)}}function s(t){try{c(o.throw(t))}catch(e){l(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))};let r,l,{text:a}=e,{onTextChange:s}=e;return u((()=>{r&&r.getModule("toolbar").container.remove()})),d((()=>o(void 0,void 0,void 0,(function*(){const{default:t}=yield M((()=>import("../../chunks/quill-91869f06.js").then((function(t){return t.q}))),["/_app/chunks/quill-91869f06.js","/_app/chunks/vendor-4bd301cf.js"]);r=new t(l,{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]}}),a&&r.setText(a.toString()),r.on("text-change",(function(t,e,n){"user"===n&&s(t)})),l.addEventListener("keydown",(function(t){if("Backspace"===t.key){const e=r.getText();""!==e&&"\n"!==e&&t.stopPropagation()}}),{capture:!0})})))),t.$$set=t=>{"text"in t&&n(1,a=t.text),"onTextChange"in t&&n(2,s=t.onTextChange)},[l,a,s,function(t){f[t?"unshift":"push"]((()=>{l=t,n(0,l)}))}]}class J extends e{constructor(t){super(),n(this,t,G,F,o,{text:1,onTextChange:2})}}function K(t){let e,n,o;return{c(){e=r("div"),n=r("h1"),o=k("Click to Edit"),this.h()},l(t){e=l(t,"DIV",{class:!0});var r=a(e);n=l(r,"H1",{});var c=a(n);o=v(c,"Click to Edit"),c.forEach(s),r.forEach(s),this.h()},h(){h(e,"class","d-flex align-items-center justify-content-center")},m(t,r){c(t,e,r),$(e,n),$(n,o)},p:i,i:i,o:i,d(t){t&&s(e)}}}function W(t){let e,n,o=t[2].toString()+"";return{c(){n=x(),this.h()},l(t){n=x(),this.h()},h(){e=new I(n)},m(t,r){e.m(o,t,r),c(t,n,r)},p(t,n){4&n&&o!==(o=t[2].toString()+"")&&e.p(o)},i:i,o:i,d(t){t&&s(n),t&&e.d()}}}function X(t){let e,n;return e=new J({props:{text:t[2],onTextChange:t[3]}}),{c(){E(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,o){y(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.text=t[2]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Y(t){let e,n,o,i,u,d;const f=[X,W,K],k=[];function v(t,e){return t[1]?0:(4&e&&(n=!!t[2].toString().trim()),n?1:2)}return o=v(t,-1),i=k[o]=f[o](t),{c(){e=r("div"),i.c(),this.h()},l(t){e=l(t,"DIV",{id:!0});var n=a(e);i.l(n),n.forEach(s),this.h()},h(){h(e,"id",u=t[0].id)},m(t,n){c(t,e,n),k[o].m(e,null),d=!0},p(t,[n]){let r=o;o=v(t,n),o===r?k[o].p(t,n):(m(),p(k[r],1,1,(()=>{k[r]=null})),g(),i=k[o],i?i.p(t,n):(i=k[o]=f[o](t),i.c()),b(i,1),i.m(e,null)),(!d||1&n&&u!==(u=t[0].id))&&h(e,"id",u)},i(t){d||(b(i),d=!0)},o(t){p(i),d=!1},d(t){t&&s(e),k[o].d()}}}function Z(t,e,n){let{block:o}=e,{edit:r}=e,l=o.text.toString();return t.$$set=t=>{"block"in t&&n(0,o=t.block),"edit"in t&&n(1,r=t.edit)},[o,r,l,function(t){var e,r;e=o.id,r=e=>{!function(t,e){let n=0;e.forEach(((e,o)=>{if(e.retain&&(n+=e.retain),"string"==typeof e.insert){const o=e.insert.split("");t.insertAt(n,...o),n+=o.length}else e.delete&&t.deleteAt(n,e.delete)}))}(e.text,t),n(2,l=e.text.toString())},R.change((({table:t})=>{const n=t.byId(e);n&&r(n)}))}]}class Q extends e{constructor(t){super(),n(this,t,Z,Y,o,{block:0,edit:1})}}function tt(t){let e,n;return e=new Q({props:{block:t[0],edit:t[1]}}),{c(){E(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,o){y(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.block=t[0]),2&n&&(o.edit=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function et(t){let e,n,o,i,u=t[0].type===z.Text&&tt(t);return{c(){e=r("div"),u&&u.c(),this.h()},l(t){e=l(t,"DIV",{class:!0});var n=a(e);u&&u.l(n),n.forEach(s),this.h()},h(){h(e,"class","mb-4")},m(r,l){c(r,e,l),u&&u.m(e,null),n=!0,o||(i=j(e,"click",_(t[2])),o=!0)},p(t,[n]){t[0].type===z.Text?u?(u.p(t,n),1&n&&b(u,1)):(u=tt(t),u.c(),b(u,1),u.m(e,null)):u&&(m(),p(u,1,1,(()=>{u=null})),g())},i(t){n||(b(u),n=!0)},o(t){p(u),n=!1},d(t){t&&s(e),u&&u.d(),o=!1,i()}}}function nt(t,e,n){let o,{block:r}=e;d((()=>{window.addEventListener("click",(()=>n(1,o=!1)))}));return t.$$set=t=>{"block"in t&&n(0,r=t.block)},[r,o,()=>n(1,o=!0)]}class ot extends e{constructor(t){super(),n(this,t,nt,et,o,{block:0})}}function rt(t,e,n){const o=t.slice();return o[5]=e[n][0],o[6]=e[n][1],o}function lt(t,e,n){const o=t.slice();return o[9]=e[n],o}function at(t){let e,n;return e=new ot({props:{block:t[9]}}),{c(){E(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,o){y(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.block=t[9]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function st(t){let e,n,o=t[5]+"";return{c(){e=r("option"),n=k(o),this.h()},l(t){e=l(t,"OPTION",{value:!0});var r=a(e);n=v(r,o),r.forEach(s),this.h()},h(){e.__value=t[6],e.value=e.__value},m(t,o){c(t,e,o),$(e,n)},p:i,d(t){t&&s(e)}}}function ct(t){let e,n,o,i,u,d,f,x,E,w,y,T,I,_,q,L,P=t[0].name+"",A=t[2].table.rows,H=[];for(let r=0;r<A.length;r+=1)H[r]=at(lt(t,A,r));const M=t=>p(H[t],1,1,(()=>{H[t]=null}));let R=Object.entries(z),U=[];for(let r=0;r<R.length;r+=1)U[r]=st(rt(t,R,r));return{c(){e=r("h1"),n=k(P),o=B(),i=r("div");for(let t=0;t<H.length;t+=1)H[t].c();u=B(),d=r("div"),f=r("form"),x=r("div"),E=r("select");for(let t=0;t<U.length;t+=1)U[t].c();w=B(),y=r("div"),T=r("button"),I=k("Create Block"),this.h()},l(t){e=l(t,"H1",{});var r=a(e);n=v(r,P),r.forEach(s),o=C(t),i=l(t,"DIV",{class:!0});var c=a(i);for(let e=0;e<H.length;e+=1)H[e].l(c);c.forEach(s),u=C(t),d=l(t,"DIV",{class:!0});var h=a(d);f=l(h,"FORM",{action:!0,class:!0});var m=a(f);x=l(m,"DIV",{class:!0});var p=a(x);E=l(p,"SELECT",{class:!0,placeholder:!0,"aria-label":!0,required:!0});var g=a(E);for(let e=0;e<U.length;e+=1)U[e].l(g);g.forEach(s),p.forEach(s),w=C(m),y=l(m,"DIV",{class:!0});var b=a(y);T=l(b,"BUTTON",{type:!0,class:!0,"aria-label":!0});var k=a(T);I=v(k,"Create Block"),k.forEach(s),b.forEach(s),m.forEach(s),h.forEach(s),this.h()},h(){h(i,"class","mt-4"),h(E,"class","form-select"),h(E,"placeholder","New Book Name"),h(E,"aria-label","New Book Name"),E.required=!0,void 0===t[1]&&V((()=>t[4].call(E))),h(x,"class","col-auto"),h(T,"type","submit"),h(T,"class","form-control btn btn-primary"),h(T,"aria-label","Create Block"),h(y,"class","col-auto"),h(f,"action","javascript:void(0);"),h(f,"class","row mt-4"),h(d,"class","d-flex align-items-center justify-content-center")},m(r,l){c(r,e,l),$(e,n),c(r,o,l),c(r,i,l);for(let t=0;t<H.length;t+=1)H[t].m(i,null);c(r,u,l),c(r,d,l),$(d,f),$(f,x),$(x,E);for(let t=0;t<U.length;t+=1)U[t].m(E,null);D(E,t[1]),$(f,w),$(f,y),$(y,T),$(T,I),_=!0,q||(L=[j(E,"change",t[4]),j(T,"click",t[3])],q=!0)},p(t,[e]){if((!_||1&e)&&P!==(P=t[0].name+"")&&S(n,P),4&e){let n;for(A=t[2].table.rows,n=0;n<A.length;n+=1){const o=lt(t,A,n);H[n]?(H[n].p(o,e),b(H[n],1)):(H[n]=at(o),H[n].c(),b(H[n],1),H[n].m(i,null))}for(m(),n=A.length;n<H.length;n+=1)M(n);g()}if(0&e){let n;for(R=Object.entries(z),n=0;n<R.length;n+=1){const o=rt(t,R,n);U[n]?U[n].p(o,e):(U[n]=st(o),U[n].c(),U[n].m(E,null))}for(;n<U.length;n+=1)U[n].d(1);U.length=R.length}2&e&&D(E,t[1])},i(t){if(!_){for(let t=0;t<A.length;t+=1)b(H[t]);_=!0}},o(t){H=H.filter(Boolean);for(let e=0;e<H.length;e+=1)p(H[e]);_=!1},d(t){t&&s(e),t&&s(o),t&&s(i),N(H,t),t&&s(u),t&&s(d),N(U,t),q=!1,O(L)}}}function it(t,e,n){let o;q(t,R,(t=>n(2,o=t)));let{book:r}=e,l=z.Text;return t.$$set=t=>{"book"in t&&n(0,r=t.book)},[r,l,o,function(){U(r.id,l)},function(){l=L(this),n(1,l)}]}class ut extends e{constructor(t){super(),n(this,t,it,ct,o,{book:0})}}function dt(t){let e,n;return{c(){e=r("div"),n=r("span"),this.h()},l(t){e=l(t,"DIV",{class:!0});var o=a(e);n=l(o,"SPAN",{class:!0,role:!0,"aria-hidden":!0}),a(n).forEach(s),o.forEach(s),this.h()},h(){h(n,"class","spinner-border spinner-border-sm"),h(n,"role","status"),h(n,"aria-hidden","true"),h(e,"class","d-flex align-items-center justify-content-center")},m(t,o){c(t,e,o),$(e,n)},p:i,i:i,o:i,d(t){t&&s(e)}}}function ft(t){let e,n;return e=new ut({props:{book:t[0]}}),{c(){E(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,o){y(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.book=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function ht(t){var e;let n,o,r,l,a,i;document.title=n="Book: "+(null==(e=t[0])?void 0:e.name);const u=[ft,dt],d=[];function f(t,e){return t[0]?0:1}return r=f(t),l=d[r]=u[r](t),{c(){o=B(),l.c(),a=x()},l(t){P('[data-svelte="svelte-1ansdeq"]',document.head).forEach(s),o=C(t),l.l(t),a=x()},m(t,e){c(t,o,e),d[r].m(t,e),c(t,a,e),i=!0},p(t,[e]){var o;(!i||1&e)&&n!==(n="Book: "+(null==(o=t[0])?void 0:o.name))&&(document.title=n);let s=r;r=f(t),r===s?d[r].p(t,e):(m(),p(d[s],1,1,(()=>{d[s]=null})),g(),l=d[r],l?l.p(t,e):(l=d[r]=u[r](t),l.c()),b(l,1),l.m(a.parentNode,a))},i(t){i||(b(l),i=!0)},o(t){p(l),i=!1},d(t){t&&s(o),d[r].d(t),t&&s(a)}}}async function mt({page:{params:t}}){return{props:{bookId:t.bookId}}}function pt(t,e,n){let o,r;q(t,H,(t=>n(2,r=t)));let{bookId:l}=e;return t.$$set=t=>{"bookId"in t&&n(1,l=t.bookId)},t.$$.update=()=>{6&t.$$.dirty&&n(0,o=r.table.rows.find((t=>t.id===l)))},[o,l,r]}export default class extends e{constructor(t){super(),n(this,t,pt,ht,o,{bookId:1})}}export{mt as load};
